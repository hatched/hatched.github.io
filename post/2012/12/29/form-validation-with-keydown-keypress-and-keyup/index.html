<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    
      <title>Form validation with keydown, keypress, and keyup &middot; From An Egg</title>
      <meta name="twitter:title" content="Form validation with keydown, keypress, and keyup" />
      <meta property="og:title" content="Form validation with keydown, keypress, and keyup" />
    
    <link rel="icon" type="image/png" alt="author's image" href="/images/me.png">
    
      
        <meta name="description" itemprop="description" content="There is quite a bit of confusion in the beginner JavaScript world as to what the difference is between the keydown, keypress, and keyup events. So I hope that the following can help clear up some of the common questions as well as provide some solutions to make your life easier when dealing with cross browser key events.
As with all DOM events there is a generally accepted order to which they fire and key events are no different.">
        <meta name="twitter:description" content="There is quite a bit of confusion in the beginner JavaScript world as to what the difference is between the keydown, keypress, and keyup events. So I hope that the following can help clear up some of the common questions as well as provide some solutions to make your life easier when dealing with cross browser key events.
As with all DOM events there is a generally accepted order to which they fire and key events are no different." />
        <meta property="og:description" content="There is quite a bit of confusion in the beginner JavaScript world as to what the difference is between the keydown, keypress, and keyup events. So I hope that the following can help clear up some of the common questions as well as provide some solutions to make your life easier when dealing with cross browser key events.
As with all DOM events there is a generally accepted order to which they fire and key events are no different." />
        
          <meta property="article:published_time" content="2012-12-29 12:58:00 -0600 CST">
        
      
    

    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@fromanegg" />
    <meta name="twitter:image" content="https://fromanegg.com/images/me.png" />

    <meta property="og:url" content="https://fromanegg.com/post/2012/12/29/form-validation-with-keydown-keypress-and-keyup/" />
    <meta property="og:type" content="article" />
    <meta property="og:image" content="https://fromanegg.com/images/me.png" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#cc181e">
    <meta name="generator" content="Hugo 0.83.1" />
    <link rel="canonical" href="https://fromanegg.com/post/2012/12/29/form-validation-with-keydown-keypress-and-keyup/"/>
    <link rel="stylesheet" href="/css/normalize-min.css">
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/manni.css">
    <link href="/rss" rel="alternate" type="application/rss+xml" title="From An Egg" />
  </head>
  <body>
    <div class="top-bar"></div>

  <nav>
  <img src="/images/me.png"></img>
  <h1 itemprop="author">Jeff Pihach</h1>
  <label for="menu-toggle" class="icon-menu">Menu</label>
  <input type="checkbox" id="menu-toggle"/>
  <div class="nav-wrapper">
    <ul>
      <li class=""><a href="/" class="icon-home">Home</a></li>
      <li class=""><a rel="author" href="/about" class="icon-help">About</a></li>
      <li class=""><a href="/posts" class="icon-box">Posts</a></li>
      <li class=""><a href="/projects" class="icon-cubes">Projects</a></li>
      <li class="">
        <label for="tags-toggle">
          <span class="icon-tag">Tags</span>
          <span class="icon-down-dir arrow"></span>
        </label>
        <input type="checkbox" id="tags-toggle"/>
        <ul class="tag-list">
          
          
            <li><a href="/tags/android">android</a></li>
          
            <li><a href="/tags/book-review">book-review</a></li>
          
            <li><a href="/tags/cordova">cordova</a></li>
          
            <li><a href="/tags/css">css</a></li>
          
            <li><a href="/tags/development">development</a></li>
          
            <li><a href="/tags/go">go</a></li>
          
            <li><a href="/tags/hatched-links">hatched-links</a></li>
          
            <li><a href="/tags/html">html</a></li>
          
            <li><a href="/tags/javascript">javascript</a></li>
          
            <li><a href="/tags/juju">juju</a></li>
          
            <li><a href="/tags/juju-gui">juju-gui</a></li>
          
            <li><a href="/tags/linux">linux</a></li>
          
            <li><a href="/tags/node.js">node.js</a></li>
          
            <li><a href="/tags/ops">ops</a></li>
          
            <li><a href="/tags/osx">osx</a></li>
          
            <li><a href="/tags/phonegap">phonegap</a></li>
          
            <li><a href="/tags/python">python</a></li>
          
            <li><a href="/tags/react">react</a></li>
          
            <li><a href="/tags/testing">testing</a></li>
          
            <li><a href="/tags/ubuntu">ubuntu</a></li>
          
            <li><a href="/tags/video">video</a></li>
          
            <li><a href="/tags/yui">yui</a></li>
          
        </ul>
      </li>
      <li><a href="https://fromanegg.com/rss.xml" class="icon-rss">RSS</a></li>
    </ul>
    <hr></hr>
    <h3>Social</h3>
    <ul class="social-list">
      <li><a href="https://github.com/hatched" class="icon-github" target="_blank">GitHub</a></li>
      <li><a href="https://twitter.com/fromanegg" class="icon-twitter" target="_blank">Twitter</a></li>
      <li><a href="https://www.youtube.com/channel/UCq2MDZ8IWAV0Jyp6FuwoJXA" class="icon-youtube-play" target="_blank">YouTube</a></li>
      <li><a href="http://stackexchange.com/users/3378894" class="icon-stackoverflow" target="_blank">StackExchange</a></li>
    </ul>
  </div>
</nav>

  <section class="article-list">
  <article itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1><a href="https://fromanegg.com/post/2012/12/29/form-validation-with-keydown-keypress-and-keyup/" itemprop="url">Form validation with keydown, keypress, and keyup</a></h1>
      
        <time pubdate content="2012-12-29 12:58:00 -0600 CST" datetime="2012-12-29 12:58:00 -0600 CST">29 December 2012</time>
      
    </header>
    <p>There is quite a bit of confusion in the beginner JavaScript world as to what the difference is between the keydown, keypress, and keyup events. So I hope that the following can help clear up some of the common questions as well as provide some solutions to make your life easier when dealing with cross browser key events.</p>
<p>As with all DOM events there is a generally accepted order to which they fire and key events are no different. When the user hits a key, the events are fired in the following sequence; keydown, keypress, keyup.</p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/Events/keydown">Keydown</a>: fired when the key is pressed but before any values have been passed to the DOM. This means that you can prevent the key from being pressed to disable user inputs.</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/Events/keypress">Keypress</a>: fired when the key which is being pressed results in a character being sent. So this excludes modifier keys, directional keys, and keys which remove text.</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/Events/keyup">Keyup</a>: fired after the user has released the key, telling you what key was pressed but because its being fired after the fact you are unable to prevent this event.
The best way to understand these events is an example. Lets say we have a currency input in a form which we want to validate as the user types.</li>
</ul>
<p>First we need some rules:</p>
<ul>
<li>Maximum value $99999.99</li>
<li>Cents are not required but available
Note: I am intentionally ignoring the possibility of a user pasting into the field as that’s out of scope of this post.</li>
</ul>
<p>Click here to view this simple example on jsbin: <a href="http://jsbin.com/oposij/1/embed?output">Simple form validation on user input</a></p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">input</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByName</span><span class="p">(</span><span class="s1">&#39;currency-field&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
    <span class="nx">currencyRegex</span> <span class="o">=</span> <span class="sr">/^[0-9]{0,5}(\.[0-9]{0,2})?$/</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">handleKeypress</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Get the string value of the charCode.
</span><span class="c1"></span>  <span class="kd">var</span> <span class="kr">char</span> <span class="o">=</span> <span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">charCode</span><span class="p">),</span>
      <span class="nx">target</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">,</span>
      <span class="nx">inputVal</span> <span class="o">=</span> <span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span>
      <span class="c1">// Construct what the value will be if the event is not prevented.
</span><span class="c1"></span>      <span class="nx">value</span> <span class="o">=</span> <span class="nx">inputVal</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">target</span><span class="p">.</span><span class="nx">selectionStart</span><span class="p">)</span> <span class="o">+</span> <span class="kr">char</span> <span class="o">+</span> <span class="nx">inputVal</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="nx">target</span><span class="p">.</span><span class="nx">selectionEnd</span><span class="p">);</span>

  <span class="c1">// Test to make sure the user is inputting only valid characters
</span><span class="c1"></span>  <span class="c1">// and that the resulting input is valid.
</span><span class="c1"></span>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="kr">char</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/[0-9.]/</span><span class="p">)</span> <span class="o">||</span> <span class="o">!</span><span class="nx">value</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">currencyRegex</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">toggleUI</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span> <span class="nx">target</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">toggleUI</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="nx">target</span><span class="p">);</span>
  <span class="p">}</span>

<span class="p">}</span>

<span class="kd">function</span> <span class="nx">handleKeyup</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">target</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">,</span>
      <span class="nx">keyCode</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">keyCode</span><span class="p">;</span>

  <span class="c1">// If the user deletes anything, test the value in the input
</span><span class="c1"></span>  <span class="c1">// again to check for validity.
</span><span class="c1"></span>  <span class="k">if</span> <span class="p">(</span><span class="nx">keyCode</span> <span class="o">===</span> <span class="mi">8</span> <span class="o">||</span> <span class="nx">keyCode</span> <span class="o">===</span> <span class="mi">46</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">currencyRegex</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">toggleUI</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span> <span class="nx">target</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">toggleUI</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="nx">target</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">toggleUI</span><span class="p">(</span><span class="nx">valid</span><span class="p">,</span> <span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">valid</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">target</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s2">&#34;valid&#34;</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">target</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s2">&#34;warning&#34;</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// On keypress or keyup, call their callback
</span><span class="c1"></span><span class="nx">input</span><span class="p">.</span><span class="nx">onkeypress</span> <span class="o">=</span> <span class="nx">handleKeypress</span><span class="p">;</span>
<span class="nx">input</span><span class="p">.</span><span class="nx">onkeyup</span> <span class="o">=</span> <span class="nx">handleKeyup</span><span class="p">;</span>
</code></pre></div><p>This example should be fairly straight forward to follow along with but there are a few points of interest that relate to key events.</p>
<ul>
<li>First, notice that I am listening on not only keypress but also keyup. This is because keypress does not fire when the user deletes a character but we still need to check the input value to be sure that it’s valid.</li>
<li>Second, you’ll see that I’m using e.charCode in the keypress handler but using e.keyCode in the keyup handler. This is because I don’t care what key was pressed on keypress, I only care what is being inserted into the input field; however on the keyup, I only care that a delete/backspace key was released but am not concerned about what was entered into the text box.
Ok so now what about keydown? Another example is in order; we’ll take the previous example, but instead of notifying the user that something is wrong, we will prevent them from inputting invalid characters</li>
</ul>
<p>Click here to view this simple example on jsbin: <a href="http://jsbin.com/oposij/2/embed?output">Prevent invalid input on form</a></p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">input</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByName</span><span class="p">(</span><span class="s1">&#39;currency-field&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
    <span class="nx">currencyRegex</span> <span class="o">=</span> <span class="sr">/^[0-9]{0,5}(\.[0-9]{0,2})?$/</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">handleKeypress</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Get the string value of the charCode.
</span><span class="c1"></span>  <span class="kd">var</span> <span class="kr">char</span> <span class="o">=</span> <span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">charCode</span><span class="p">),</span>
      <span class="nx">target</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">,</span>
      <span class="nx">inputVal</span> <span class="o">=</span> <span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span>
      <span class="c1">// Construct what the value will be if the event is not prevented.
</span><span class="c1"></span>      <span class="nx">value</span> <span class="o">=</span> <span class="nx">inputVal</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">target</span><span class="p">.</span><span class="nx">selectionStart</span><span class="p">)</span> <span class="o">+</span> <span class="kr">char</span> <span class="o">+</span> <span class="nx">inputVal</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="nx">target</span><span class="p">.</span><span class="nx">selectionEnd</span><span class="p">);</span>

  <span class="c1">// Test to make sure the user is inputting only valid characters
</span><span class="c1"></span>  <span class="c1">// and that the resulting input is valid.
</span><span class="c1"></span>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="kr">char</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/[0-9.]/</span><span class="p">)</span> <span class="o">||</span> <span class="o">!</span><span class="nx">value</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">currencyRegex</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
  <span class="p">}</span>

<span class="p">}</span>

<span class="kd">function</span> <span class="nx">handleKeydown</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">target</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">,</span>
      <span class="nx">keyCode</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">keyCode</span><span class="p">,</span>
      <span class="nx">inputVal</span> <span class="o">=</span> <span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span>
      <span class="nx">value</span><span class="p">;</span>

  <span class="c1">// If the user deletes anything, construct the resulting
</span><span class="c1"></span>  <span class="c1">// value to determine validity.
</span><span class="c1"></span>  <span class="k">if</span> <span class="p">(</span><span class="nx">keyCode</span> <span class="o">===</span> <span class="mi">8</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">value</span> <span class="o">=</span> <span class="nx">inputVal</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">target</span><span class="p">.</span><span class="nx">selectionStart</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="nx">inputVal</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="nx">target</span><span class="p">.</span><span class="nx">selectionEnd</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">keyCode</span> <span class="o">===</span> <span class="mi">46</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">value</span> <span class="o">=</span> <span class="nx">inputVal</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">target</span><span class="p">.</span><span class="nx">selectionStart</span><span class="p">)</span> <span class="o">+</span> <span class="nx">inputVal</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="nx">target</span><span class="p">.</span><span class="nx">selectionEnd</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
  <span class="p">}</span>    
  <span class="k">if</span> <span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">value</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">currencyRegex</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// On keypress or keyup, call their callback
</span><span class="c1"></span><span class="nx">input</span><span class="p">.</span><span class="nx">onkeypress</span> <span class="o">=</span> <span class="nx">handleKeypress</span><span class="p">;</span>
<span class="nx">input</span><span class="p">.</span><span class="nx">onkeydown</span> <span class="o">=</span> <span class="nx">handleKeydown</span><span class="p">;</span>
</code></pre></div><p>You can see by this last example that by using keydown we can listen for the delete or backspace key, check the resulting input value, and if it’s invalid, prevent the user action.</p>
<p>As with anything front end related there are going to be cross browser differences so I highly recommend using one of the quality javascript libraries and frameworks available to normalize these differences for you. If you have read any of my other posts you have probably guessed that I’m partial to the <a href="http://yuilibrary.com/">YUI framework</a>.</p>
<p>I hope that these examples not only show you how keyup, keydown, and keypress function; but also give you some ideas on the best situations to use them. If you have any questions feel free to comment below or mention me <a href="https://twitter.com/fromanegg">@fromanegg</a></p>

  </article>
</section>

  <section class="article-list tags-list">
  <article>
    
    <ul class="icon-tag">
      
        <li><a href="/tags/yui">yui</a></li>
      
        <li><a href="/tags/javascript">javascript</a></li>
      
    </ul>
    
  </article>
</section>

  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-28934249-1', 'auto');
  ga('send', 'pageview');
</script>

  </body>
</html>

